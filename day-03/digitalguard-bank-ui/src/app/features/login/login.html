<p-toast position="top-center"></p-toast>

<div class="flex justify-content-center align-items-center min-h-screen">
    <p-card styleClass="shadow-4" [style]="{width: '450px'}">
        <h2 class="text-center mb-4">DigitalGuard Bank</h2>

        <p-tabs [value]="activeTab()">
            <p-tablist>
                <p-tab [value]="0" (click)="activeTab.set(0)">Acceder</p-tab>
                <p-tab [value]="1" (click)="activeTab.set(1)">Registrarse</p-tab>
            </p-tablist>

            <p-tabpanels>
                <p-tabpanel [value]="0">
                    <form [formGroup]="loginForm" class="flex flex-column gap-3 mt-3">
                        <input pInputText formControlName="username" placeholder="Usuario" autocomplete="username" />
                        <input pInputText type="password" formControlName="password" placeholder="Contraseña" autocomplete="current-password" />
                        
                        <p-button label="Identificarse" (onClick)="onLogin()" />
                    </form>
                </p-tabpanel>

                <p-tabpanel [value]="1">
                    <form [formGroup]="registerForm" class="flex flex-column gap-3 mt-3">
                        <div class="flex gap-2">
                            <input pInputText formControlName="name" placeholder="Nombre" class="w-full" />
                            <input pInputText formControlName="secondName" placeholder="Apellidos" class="w-full" />
                        </div>
                        <input pInputText formControlName="username" placeholder="Usuario" autocomplete="username" />
                        <input pInputText type="password" formControlName="password" placeholder="Contraseña" autocomplete="new-password" />
                        <input pInputText formControlName="secretPin" placeholder="PIN Secreto (Ej: 1234)" maxlength="6" />

                        <p-button label="Crear Cuenta" severity="success" (onClick)="onRegister()" 
                            [disabled]="registerForm.invalid" />
                    </form>
                </p-tabpanel>
            </p-tabpanels>
        </p-tabs>
    </p-card>
</div>

<p-dialog header="Seguridad Requerida" [(visible)]="visiblePinModal" [modal]="true" [draggable]="false" [resizable]="false" [style]="{width: '300px'}">
    <div class="flex flex-column gap-3" [formGroup]="loginForm">
        <p class="text-center m-0 text-gray-400">Introduce tu PIN secreto</p>
        
        <input pInputText type="password" formControlName="pin" class="text-center text-2xl" maxlength="6" placeholder="******" />
        
        <p-button label="Validar Acceso" (onClick)="onVerifyPin()" severity="success" class="w-full" />
    </div>
</p-dialog>